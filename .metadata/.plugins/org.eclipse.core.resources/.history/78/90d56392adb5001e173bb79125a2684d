window.addEventListener("load", function(){
	let readButton = document.querySelector("form .read-button");
	let resultSection = document.querySelector("table tbody");

	readButton.onclick = async (e)=>{
		e.preventDefault();
		let id = document.querySelector("input[name='id']").value;
		let name = document.querySelector("input[name='name']").value;
		let email = document.querySelector("input[name='email']").value;
		
		let response;
		if (id == null && name == null && email == null) {
			resultSection.innerHTML = "";
			let template = `
				<tr>
		            <td>|</td>
		            <td>${jsonData.id}</td><td>|</td>
		            <td>${jsonData.name}</td><td>|</td>
		            <td>${jsonData.email}</td><td>|</td>
		        </tr>
			`;
			resultSection.insertAdjacentHTML("beforeend", template);
		}
		else if (id != null)
	        response = await fetch(`/listdb?id=${id}`);
	    else if (name != null)
	    	response = await fetch(`/listdb?name=${name}`);
	    else if (email != null)
	    	response = await fetch(`/listdb?email=${email}`);
	    else
	    	response = await fetch(`/listdb?id=${id}&name=${name}&email=${email}`);
		let jsonData;
		if(response) {
			jsonData = await response.json();
			console.log(jsonData);
		}
		
		function result(id, name, email) {
			return `
		        <tr>
		            <td>|</td>
		            <td>${id}</td><td>|</td>
		            <td>${name}</td><td>|</td>
		            <td>${email}</td><td>|</td>
		        </tr>
	        `;
		}
	}
})